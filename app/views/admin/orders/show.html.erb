<h2><%= @order.customer.last_name + @order.customer.first_name %>さんの注文詳細</h2>

<p>購入者：<%= @order.customer.last_name + @order.customer.first_name %></p>
<p>注文日：<%= @order.created_at.strftime('%Y年%m月%d日') %></p>
<p>配送先：<%= @order.address %></p>
<p>支払方法：<%= @order.payment_method %></p>

<%= form_for([:admin, @order]) do |f| %>
  <%= f.label :status, "注文ステータス" %><br />
  <%= f.select :status, Order.statuses.keys.map {|k| [I18n.t("activerecord.attributes.order.statuses.#{k}"), k]} %>
  <%= f.submit "更新" %>
<% end %>

<h3>注文商品一覧</h3>

<% @order.order_details.each do |detail| %>
  <p>
    <%= detail.item.name %> 
    <%= detail.price %>円（税込） 
    <%= detail.amount %>個 
    小計：<%= detail.price * detail.amount %>円 
    制作ステータス：
    <%= form_for([:admin,detail]) do |f| %>
      <%= f.select :making_status, OrderDetail.making_statuses.keys.map {|k| [I18n.t("activerecord.attributes.order_detail.making_statuses.#{k}"), k]} %>
      <%= f.submit "更新" %>
    <% end %>
  </p>
<% end %>

<p>商品合計金額：<%= @order.order_details.sum {|detail| detail.price * detail.amount } %>円</p>
<p>送料：800円</p>
<p>請求合計金額：<%= @order.order_details.sum {|detail| detail.price * detail.amount } + 800 %>円</p>
